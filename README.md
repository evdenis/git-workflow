# Программы для работы с репозитарием AstraVer

Предназначение программ - ускорить и облегчить следование правилам, описанным здесь [Правила ведения репозитория AstraVer](http://stable.intra.ispras.ru/projects/astraver/wiki/%D0%9F%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D0%B0_%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F_%D1%80%D0%B5%D0%BF%D0%BE%D0%B7%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D1%8F_astraver-spec)

Программы используют переменную окружения **CURRENT\_PROJECT** как указатель на папку/подпапку репозитория проекта AstraVer.

## av-import-to-master

Программа для импортирования в ветвь master нового релиза. Аргумент - зашифрованный tar архив. Ключ шифрования должен находиться в файле **.config**(plain text, просто ключ и ничего больше) в папке с программой, либо вводиться каждый раз.

## av-list-notes

Вывести всю доступную информацию в репозитарии по git-notes.

## av-list-old-notes

Вывести всю доступную информацию в репозитарии по git-notes в старых номерных ветвях.

## av-list-invalid

Проверить, что все метки в git-notes имеют правильный формат и не содержат опечаток. Если в note описан идентификатор коммита, существование данного коммита проверяется.

## av-new-branch

Создать новую номерную ветвь devel|spec (зависит от аргумента) правильным образом со всеми предварительными проверками.

## av-merge-branch

Сделать слияние номерной ветви и безномерной с полным переписыванием содержимого.

## av-check-merged

Проверить, были ли последние номерные ветви слиты с безномерными.

## av-cherrypick

При новом релизе переносит коммиты со старых номерных и безномерных ветвей на новые номерные ветви, упраляет ими в соответствии с notes. Переносит, обновляет notes. Удаляет notes со старых ветвей. Работает в полу-автоматическом режиме. Если коммит не переносится, программа посылает сама себе сигнал SIGSTOP и ожидает, что к моменту её запуска (**fg**) пользователь внесёт необходимые изменения и завершит коммит самостоятельно. В случае, если коммит переносить более не требуется в связи с изменениями в новом релизе, пользователь при остановке программы может создать пустой файл drop\_commit в папке .git, но всё-равно должен корректно в ручном режиме завершить коммит. В таком случае программа сформирует патч из только что созданного коммита в отдельный файл и отменит его в репозитории.
